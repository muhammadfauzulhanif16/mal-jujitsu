import{r as b,j as e,B as c,O as G}from"./app-Pz5Td4aK.js";import{b as k,F as M,T,a as P,A as H,S as f,G as n,B as W,j as K,k as t}from"./AppLayout-CgstnK6u.js";import{B as O}from"./Breadcrumbs-Lj6BezEw.js";import{T as h,b as J,I as U}from"./Table-CwfaiOXO.js";import{S as _}from"./Select-Dkx4wJR-.js";import{I as D,G as l}from"./IconCalendar-b2aWmR8n.js";import{S as q}from"./SimpleGrid-BZhHdUnw.js";import{D as Q}from"./Divider-Cwnu1Ulg.js";import{T as y}from"./Title-xuOukjAe.js";import{L as F,T as V}from"./TypographyStylesProvider-BHXlwyez.js";import{C as o}from"./Center-CNROwVXS.js";import"./ScrollArea-qritgqCM.js";import"./OptionsDropdown-Bt-osuS7.js";import"./CheckIcon-C34qmD5j.js";import"./get-base-value-BRmQQuPj.js";const pe=r=>{var S;console.log(r);const[w,p]=b.useState(null),C=w===null?r.evaluations:r.evaluations.filter(s=>s.period===Number(w)),[v,X]=b.useState(""),R=[{title:"#"},{title:"Foto"},{title:"Nama Lengkap",key:"full_name"},{title:"Sistem Pertandingan",key:"role"},{title:"Total Penilaian",key:"total_evaluations"},{title:"Aksi"}],I=s=>{var i;return(i=C.find(a=>a.id===s))==null?void 0:i.tournaments.reduce((a,d)=>d.medal==="Emas"?a+3:d.medal==="Perak"?a+2:d.medal==="Perunggu"?a+1:a,0)},z=[{label:"Rincian Laporan",icon:e.jsx(U,{}),onClick:s=>G.get(route("reports.show",s.id)),color:"blue"}],B=(S=r.athletes)==null?void 0:S.filter(s=>s.full_name.replace(/\s/g,"").toLowerCase().match(new RegExp(v.replace(/\s/g,"").toLowerCase(),"i"))),[j,N]=b.useState(B.map(s=>({...s,total_evaluations:s.total_evaluations.toString()}))),A=j==null?void 0:j.map((s,i)=>e.jsxs(h.Tr,{h:64,children:[e.jsx(h.Td,{px:16,py:0,style:{whiteSpace:"nowrap"},children:i+1}),e.jsx(h.Td,{px:16,py:0,style:{whiteSpace:"nowrap"},children:e.jsx(k,{src:s.avatar,alt:s.full_name})}),e.jsx(h.Td,{px:16,py:0,style:{whiteSpace:"nowrap"},children:s.full_name}),e.jsx(h.Td,{px:16,py:0,style:{whiteSpace:"nowrap"},children:s.role}),e.jsx(h.Td,{px:16,py:0,style:{whiteSpace:"nowrap"},children:s.total_evaluations}),e.jsx(h.Td,{px:16,py:0,style:{whiteSpace:"nowrap"},children:e.jsx(M,{gap:8,style:{whiteSpace:"nowrap"},children:z.map((a,d)=>e.jsx(T,{label:a.label,style:{borderRadius:32,padding:".5rem 1rem"},children:e.jsx(P,{size:48,radius:32,variant:"subtle","aria-label":a.label,color:a.color,onClick:()=>a.onClick(s),disabled:r.auth.user.id===s.id||a.disabled,children:a.icon})},d))})})]},i)),$=s=>{N(s)};return e.jsxs(H,{title:"Laporan",authed:r.auth.user,meta:r.meta,unreadHistories:r.total_unread_histories,children:[e.jsxs(f,{mb:32,children:[e.jsxs(n,{w:"100%",justify:"space-between",children:[e.jsx(O,{navList:[{label:"Laporan"}]}),["Ne-Waza","Fighting"].includes(r.auth.user.role)&&e.jsxs(n,{children:[e.jsx(_,{display:{base:"none",xs:"block"},w:240,leftSection:e.jsx(D,{}),placeholder:"Pilih periode...",variant:"filled",clearable:!0,searchable:!0,nothingFoundMessage:"Tidak ada periode ditemukan",checkIconPosition:"right",onChange:s=>{p(s===null?null:s)},data:r.evaluations.map(s=>({label:`${s.period}`,value:`${s.period}`})),allowDeselect:!0,styles:{label:{marginBottom:8},input:{height:48,borderRadius:32,paddingLeft:50,paddingRight:16},section:{marginLeft:0,width:48,height:48},error:{marginTop:8}}}),r.auth.user.role.includes("Pelatih")&&e.jsxs(e.Fragment,{children:[e.jsx(T,{style:{borderRadius:32,padding:".5rem 1rem"},label:"Cetak",children:e.jsx(P,{ml:"auto",h:48,w:48,color:"gold.2",radius:32,display:{base:"block",sm:"none"},onClick:()=>window.print(),children:e.jsx(IconPrinter,{})})}),e.jsx(W,{display:{base:"none",sm:"block"},w:240,leftSection:e.jsx(IconPrinter,{}),variant:"filled",color:"gold.2",h:48,radius:32,px:16,styles:{section:{marginRight:12}},onClick:()=>window.print(),children:"Cetak"})]})]})]}),["Ne-Waza","Fighting"].includes(r.auth.user.role)&&e.jsx(_,{w:"100%",clearable:!0,searchable:!0,allowDeselect:!0,nothingFoundMessage:"Tidak ada periode ditemukan",display:{base:"block",xs:"none"},leftSection:e.jsx(D,{}),placeholder:"Pilih periode...",variant:"filled",checkIconPosition:"right",onChange:s=>{p(s===null?null:s)},data:r.evaluations.map(s=>({label:`${s.period}`,value:`${s.period}`})),styles:{label:{marginBottom:8},input:{height:48,borderRadius:32,paddingLeft:50,paddingRight:16},section:{marginLeft:0,width:48,height:48},error:{marginTop:8}}})]}),["Ne-Waza","Fighting"].includes(r.auth.user.role)?e.jsxs(f,{gap:80,children:[e.jsxs(l,{align:"center",children:[e.jsx(l.Col,{span:4,children:e.jsx(k,{src:r.auth.user.avatar,alt:r.auth.user.full_name,size:160})}),e.jsx(l.Col,{span:8,children:e.jsxs(q,{cols:2,children:[e.jsxs(c,{children:[e.jsx(t,{children:"Nama Lengkap :"}),e.jsx(t,{fw:600,children:r.auth.user.full_name})]}),e.jsxs(c,{children:[e.jsx(t,{children:"Jenis Kelamin :"}),e.jsx(t,{fw:600,children:r.auth.user.gender})]}),e.jsxs(c,{children:[e.jsx(t,{children:"Tanggal Lahir :"}),e.jsx(t,{fw:600,children:new Date(r.auth.user.birth_date).toLocaleDateString("id").split("/").join("-")})]}),e.jsxs(c,{children:[e.jsx(t,{children:"Alamat Surel :"}),e.jsx(t,{fw:600,children:r.auth.user.email})]}),e.jsxs(c,{children:[e.jsx(t,{children:"Sistem Pertandingan :"}),e.jsx(t,{fw:600,children:r.auth.user.role})]}),e.jsxs(c,{children:[e.jsx(t,{children:"Berat Badan :"}),e.jsxs(t,{fw:600,children:[r.auth.user.athlete.weight," kg"]})]})]})})]}),C.map(s=>e.jsxs(f,{gap:32,children:[e.jsx(Q,{label:`Periode ${s.period} (${new Date(s.start_date).toLocaleDateString("id").split("/").join("-")} - ${new Date(s.end_date).toLocaleDateString("id").split("/").join("-")})`,labelPosition:"center",styles:{label:{fontSize:14}}}),s.exercises.length&&e.jsxs(c,{children:[e.jsx(y,{fz:26,mb:8,children:"Daftar Latihan"}),e.jsx(F,{type:"ordered",children:s.exercises.map(i=>e.jsxs(F.Item,{children:[i.name," di ",i.place," pada",new Date(i.date).toLocaleDateString("id").split("/").join("-")]},i.id))})]}),s.tournaments.length&&e.jsxs(c,{children:[e.jsx(y,{fz:26,mb:8,children:"Daftar Pertandingan"}),e.jsxs(l,{gutter:0,children:[e.jsx(l.Col,{span:9,children:e.jsx(n,{style:{border:"1px solid #e1e1e1"},px:16,h:48,fw:600,children:"Nama Pertandingan"})}),e.jsx(l.Col,{span:3,children:e.jsx(o,{style:{border:"1px solid #e1e1e1"},px:16,h:48,fw:600,children:"Medali (Poin)"})}),e.jsx(l.Col,{span:9,children:e.jsx(n,{style:{border:"1px solid #e1e1e1"},px:16,h:48,fw:600})}),e.jsx(l.Col,{span:1,children:e.jsx(o,{style:{border:"1px solid #e1e1e1"},px:16,h:48,fw:600,children:"Emas (3)"})}),e.jsx(l.Col,{span:1,children:e.jsx(o,{style:{border:"1px solid #e1e1e1"},px:16,h:48,fw:600,children:"Perak (2)"})}),e.jsx(l.Col,{span:1,children:e.jsx(o,{style:{border:"1px solid #e1e1e1"},px:16,h:48,fw:600,children:"Perunggu (1)"})}),s.tournaments.map(i=>e.jsxs(e.Fragment,{children:[e.jsx(l.Col,{span:9,children:e.jsx(n,{style:{border:"1px solid #e1e1e1"},px:16,h:48,children:i.name})}),e.jsx(l.Col,{span:1,children:e.jsx(o,{style:{border:"1px solid #e1e1e1"},px:16,h:48,children:i.medal==="Emas"?1:"-"})}),e.jsx(l.Col,{span:1,children:e.jsx(o,{style:{border:"1px solid #e1e1e1"},px:16,h:48,children:i.medal==="Perak"?1:"-"})}),e.jsx(l.Col,{span:1,children:e.jsx(o,{style:{border:"1px solid #e1e1e1"},px:16,h:48,children:i.medal==="Perunggu"?1:"-"})})]})),e.jsx(l.Col,{span:9,children:e.jsx(n,{style:{border:"1px solid #e1e1e1"},px:16,h:48,children:"Total"})}),e.jsx(l.Col,{span:3,children:e.jsx(o,{style:{border:"1px solid #e1e1e1"},px:16,h:48,children:I(s.id)})})]})]}),e.jsxs(c,{children:[e.jsx(y,{fz:26,mb:8,children:"Daftar Penilaian"}),e.jsxs(l,{gutter:0,children:[e.jsx(l.Col,{span:11,children:e.jsx(n,{style:{border:"1px solid #e1e1e1"},px:16,h:48,fw:600,children:"Kriteria"})}),e.jsx(l.Col,{span:1,children:e.jsx(o,{style:{border:"1px solid #e1e1e1"},px:16,h:48,fw:600,children:"Nilai"})}),s.criterias.map((i,a)=>e.jsxs(e.Fragment,{children:[e.jsx(l.Col,{children:e.jsx(o,{style:{border:"1px solid #e1e1e1"},px:16,h:48,fw:600,children:i.name.toUpperCase()})},a),i.sub_criterias.map((d,u)=>{const g=String.fromCharCode(65+u);return e.jsxs(e.Fragment,{children:[e.jsx(l.Col,{children:e.jsxs(n,{style:{border:"1px solid #e1e1e1"},px:16,fw:600,h:48,children:[g,". ",d.name]})},u),d.sub_sub_criterias.map((m,x)=>e.jsxs(e.Fragment,{children:[e.jsx(l.Col,{span:11,children:e.jsxs(n,{style:{border:"1px solid #e1e1e1"},px:16,h:48,children:[x+1,". ",m.name]})},x),e.jsx(l.Col,{span:1,children:e.jsx(n,{style:{border:"1px solid #e1e1e1"},px:16,h:48,children:m.evaluation.value})})]}))]})}),i.type==="radio"&&e.jsxs(e.Fragment,{children:[e.jsx(l.Col,{span:11,children:e.jsx(n,{style:{border:"1px solid #e1e1e1"},px:16,h:48,children:"Rata-rata"})}),e.jsx(l.Col,{span:1,children:e.jsx(n,{style:{border:"1px solid #e1e1e1"},px:16,h:48,children:(()=>{let d=0;const u=i.sub_criterias.reduce((g,m)=>{const x=m.sub_sub_criterias.reduce((L,E)=>({sum:L.sum+Number(E.evaluation.value),count:L.count+1}),{sum:0,count:0});return d+=x.count,g+x.sum},0);return Number((u/d).toFixed(2))})()})})]})]})),e.jsx(l.Col,{span:12,children:e.jsxs(n,{style:{overflow:"auto",border:"1px solid #e1e1e1"},px:16,py:11,children:[e.jsx(t,{fw:600,children:"Catatan : "}),e.jsx(V,{children:e.jsx("div",{dangerouslySetInnerHTML:{__html:s.note}})})]})})]})]})]},s.id))]}):e.jsx(J,{thList:R,tdList:A,icon:e.jsx(K,{size:48}),title:"Laporan",data:j,handleSort:$})]})};export{pe as default};
